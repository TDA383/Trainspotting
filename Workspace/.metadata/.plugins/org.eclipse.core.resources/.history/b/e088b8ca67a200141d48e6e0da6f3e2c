import java.util.concurrent.*;

import TSim.*;

public class TrainSemaphore extends Semaphore {

	private Train t;
	
	public TrainSemaphore(int permits) {
		super(permits);
	}
	
	public void acquire(Train t) throws InterruptedException {
		if (t1 != null) {
			t1 = t;
		} else if (t2 != null) {
			t2 = t;
		} else {
			super.acquire();
			return;
		}
		t.changeSpeed(t.getSpeed());
		super.acquire();
	}
	
	public void release() {
		super.release();
		if (t2 != null) {
			t2.changeSpeed(t2.getSpeed());
			t2 = null;
		} else if (t1 != null) {
			t1.changeSpeed(t1.getSpeed());
			t1 = null;
		}
	}
}
